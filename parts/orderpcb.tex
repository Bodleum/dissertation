% ====   Order p^3   ====
\section{Groups of Order \(p^3\)}
Finally, we come to our last general argument for \(p\)-groups: order \(p^3\).

\begin{theorem}\label{thm:p_cubed}
    For a prime \(p\), any group of order \(p^3\) is isomorphic to one of:
    \[%
        C_{p^3}, \quad%
        C_{p^2} \times C_p, \quad%
        C_p \times C_p \times C_p
    \]
    \[
        D_8 \quad \text{or} \quad%
        Q_8 \tag{when \(p = 2\)}
    \]
    \[
        \UT_3(p) \quad \text{or} \quad%
        C_{p^2} \rtimes C_p \tag{when \(p \geqslant 3\)}
    \]
\end{theorem}

Before we begin the proof, it will be beneficial to briefly recall a couple of definitions.
\begin{definition}
    The \emph{commutator} of \(a\) and \(b\) is \(\comex{a}{b}\), denoted by \(\com{a}{b}\).

    The \emph{derived subgroup} of \(G\), \(G' = \gen{\com{x}{y} \mid x,\,y \in G}\), is the smallest normal
    subgroup such that \(G/G'\) is abelian.
\end{definition}

The remainder of the section will be the proof of Theorem~\ref{thm:p_cubed}.
The proof is based on the one found on the Groupprops subwiki\footcite{pcubed}.
Let \(G\) be a group of order \(p^3\), where \(p\) is a prime number.
We will first gain a handle on \(G\) by describing its centre, and quotient by it.
If \(G\) is abelian, we know by the Fundamental Theorem of Finite Abelian Groups that it is isomorphic to one of:
    \[C_{p^3}, \quad C_{p^2} \times C_p \quad \text{or} \quad C_p \times C_p \times C_p
    \tag{\star}\label{eqn:p_cubed_abelian}\]
So from now on, we will focus on the non-abelian groups.

Denote the centre of \(G\) by \(Z\) and consider its order.
Lagrange's~Theorem tells us \(Z\) must have order dividing \(p^3\).
It cannot be \(p^3\) because \(G\) is non-abelian, and Lemma~\ref{lem:z_non_trivial} tells us that it cannot be 1.
If \(|Z| = p^2\), then \(|G/Z| = p\), so \(G/Z \cong C_p\).
However Lemma~\ref{lem:cyclic_over_centre} says that then \(G\) must be abelian, so then \(|Z|\) must be \(p\).
By our previous classification, \(G/Z\) is isomorphic to either \(C_{p^2}\) or \(C_p \times C_p\).
Lemma~\ref{lem:cyclic_over_centre} tells us that it must by the latter.

This gives us a handle to start investigating the structure of \(G\).
We saw that \(G/Z\) is abelian, so \(G' \leqslant Z\), but because \(G'\) is non-trivial, we must have equality.

So far, we know \(G/Z \cong C_p \times C_p\), and that \(G' = Z\).
Now pick two elements, \(a\) and \(b\) so that \(aZ\) and \(bZ\) generate \(G/Z\).
So then \(G = \gen{Z,\,a,\,b}\).

Let \(z = \com{a}{b}\).
If \(z = 1\) then that means \(a\) and \(b\) commute.
And by definition, \(a\) commutes with \(Z\), so \(a \in Z\), which contradicts our choice of \(a\) as a generator of
\(G/Z\).
Hence \(z \neq 1\), and in particular, \(a\) and \(b\) do not commute.
Now we know \(G' = Z\) which has order \(p\), so \(Z \cong C_p\).
Moreover, \(z \in Z\), and \(z \neq 1\) so we can conclude that \(\gen{z} = Z\).
We can see that although \(a\) and \(b\) are not in \(Z\), \(a^p\) and \(b^p\) are, because \(aZ\) and \(bZ\) have order
\(p\) in \(G/Z\).
Considering the orders of \(a\) and \(b\) we have 3 cases: both have order \(p\), one of order \(p\) and the other
    \(p^2\), and both of order \(p^2\).

Because when \(p\) is odd or even have different behaviours, we will break the remainder of the proof into two
    sub-lemmas.

\begin{lemma}
    For an odd prime \(p\), the non-abelian groups of order \(p^3\) are:
    \[%
        \UT_3(p) \quad \text{and} \quad%
        C_{p^2} \rtimes C_p
    \]
\end{lemma}

\begin{proof}
Continuing from above, we have the following relations:
\[ \com{a}{b} = z \neq 1, \quad \gen{z} = \z, \quad a,\,b \notin \z, \quad \text{and} \quad a^p,\,b^p \in \z \]

\begin{case}
    \item Both \(a\) and \(b\) have order \(p\).

        Writing a presentation from the above relations:
        \[G = \gen{z,\,a,\,b \mid z^p = a^p = b^p = 1,\ az = za,\ bz = zb,\ \com{a}{b} = z} \tag{\dag}\label{eqn:p_cubed_dag}\]
        We can write an arbitrary \(g \in G\) as \(a^i b^j z^k\) for integers \(i\), \(j\) and \(k\) taken mod \(p\).
        Hence the group definied by (\ref{eqn:p_cubed_dag}) has order at most \(p^3\), but not necessarily realised by a group of order \(p^3\).

        Now consider the set:
        \[\left\{\,\unimat{\alpha}{\beta}{\gamma} \mid \alpha,\,\beta,\,\gamma \in \F_p\,\right\}\]
        It can be shown that this is a group under the usual matrix multiplication, and is known as the
        \emph{unitriangular group}\footcite{unitriangular}, denoted \(\UT_3(p)\).
        Taking:
        \[z = \unimat{0}{1}{0}, \quad a = \unimat{1}{0}{0} \quad \text{and} \quad b = \unimat{0}{0}{1}\]
        we can check that \(\UT_3(p)\) satisfies (\ref{eqn:p_cubed_dag}).
        (Indeed, it is the standard presentation defining \(\UT_3(p)\)).
        Thus (\ref{eqn:p_cubed_dag}) is realised by a group of order \(p^3\), so there is a single isomorphism class for
        this case.

        We will quickly show that \(\UT_3(p)\) has elements of order at most \(p\).
        Any element can be written as \(a^i b^j z^k\).
        Moreover, \(a\) and \(b\) commute with \(z\), and we can swap \(a\) and \(b\) at the price of introducing a
        \(z\).
        So an element has order dividing \(\lcm(\order(a),\, \order(b),\, \order(z)) = p\).
        Hence an element of \(\UT_3(p)\) has order 1 or \(p\).

    \item One element of each order \(p\) and \(p^2\).

        The roles of \(a\) and \(b\) are interchangeable, so we can take \(a\) to have order \(p^2\) and \(b\) to have
        order \(p\) without loss of generality.
        So \(\gen{a} \cong C_{p^2}\), and has index \(p\), so by Lemma~\ref{lem:index_p_normal} is normal.
        We noted that \(a^p \neq 1\) is in \(Z\), and so \(a^p\) is some power of \(z\), say \(a^p = z^r\), with \(r\)
        taken mod \(p\).

        We know that \(0 < r < p\) and I claim that we can take \(r = 1\) without loss of generality.
        Because \(z^r \neq 1\), it has order \(p\).
        Hence \(z^r\) generates \(Z\).
        Because \(p\) is prime, \(Z \cong C_p\) is a finite field.
        Therefore, there exists some integer \(s\), with \(0 < s < p\) such that \(sr \equiv 1 \pmod{p}\).
        Then say \(\bar{a} = a^s\) so:
        \[\bar{a}^p = {(a^s)}^p = {(a^p)}^s = {(z^r)}^s = z \pmod{p}\]
        Indeed we can take \(\bar{a}^p\) to be any power of \(z\) we want using a similar substitution.
        This is actually a sneaky application of Lemma~\ref{lem:semiisom}, because it will turn out that \(G\) can be
        written as a semidirect product.

        Take \(a^p = z\).
        Now because \(G = \gen{z,\,a,\,b}\), \(\gen{a} \cap \gen{b} = \bm{1}\).
        So we can conclude that \(G = \gen{a} \rtimes \gen{b}\).
        How does \(b\) conjugate \(a\)?
        Consider:
        \[\comex{a}{b} = \com{a}{b} = z = a^p\]
        So:
        \[b^{-1}ab = a^{p + 1}\]
        Thus:
        \[G \cong C_{p^2} \rtimes C_p\]
        With presentation:
        \[\gen{a,\,b \mid a^{p^2} = b^p = 1,\ b^{-1}ab = a^{p + 1}}\]
        We can see that this is not isomorphic to the previous case, because \(\UT_3(p)\) has no element of order \(p^2\).

    \item Both \(a\) and \(b\) have order \(p^2\).

        We will show that by substitutions, this is equivalent to the above.
        In the previous case, we saw that we can take \(a^p\) and \(b^p\) to be arbitrary powers of \(z\) using
        substitutions (which is Lemma~\ref{lem:semiisom} behind the scenes).
        So take \(a^p = z\) and \(b^p = z^{-1}\).
        Let \(d = ab\), and consider:
        \[ d^p = {(ab)}^p = abab\ldots ab\]
        We will collect together the \(a\)'s and \(b\)'s, maintaining equality with the commutator, \(\com{a}{b} = z\):
        \begin{align*}
            d^p &= ababab\ldots ab \\
            &= z aabbab\ldots ab \\
            &= z^2 aababb\ldots ab \\
            &= z^3 aaabbb\ldots ab \\
            &\ \,\vdots \\  % Weird spacing
            &= z^{\frac{p(p-1)}{2}} a^p b^p \tag{\ddag} \label{eqn:p_cubed_ddag}
        \end{align*}
        However, \(z^p = 1\) so:
        \[d^p = a^p b^p = zz^{-1} = 1\]
        So \(d\) has order \(p\), and we are back in the previous case.
\end{case}
\end{proof}

Now we will consider the case when \(p = 2\).
\begin{lemma}
    The non-abelian groups of order 8 are:
    \[%
        D_8 \quad \text{and} \quad%
        Q_8
    \]
\end{lemma}

\begin{proof}
Leveraging the work we've already done, let's consider how the 3 cases behave when \(p=2\):

\begin{case}
    \item \(G \cong \UT_3(2)\).

        The group behaves differently when \(p = 2\) because we know that a group whose elements all have order either 1
        or 2 is abelian.
        So the elements cannot have order only 1 or 2.
        In particular:
        \[\unimat{1}{0}{1} \quad \text{and} \quad \unimat{1}{1}{1}\]
        have order 4.
        We can check that all other non-identity elements have order 2.
        Thus \(\UT_2(2) \cong D_8\).

    \item \(G = \gen{a,\,b \mid a^{p^2} = b^p = 1,\ b^{-1}ab = a^{p + 1}}\)

        When \(p = 2\), this reduces to the dihedral group, \(D_8\).

    \item Both \(a\) and \(b\) have order 4.

        If \(p = 2\), (\ref{eqn:p_cubed_ddag}) does not hold, and the exponent of \(z\) is 1 in that case.
        So we have the relations:
        \[a^4 = b^4 = z^2 = 1, \quad a^2 = z, \quad b^2 = z^{-1} \quad \text{and} \quad \com{a}{b} = z\]
        Therefore:
        \[b^{-1}ab = az = a^3 = a^{-1}\]
        So we obtain the presentation:
        \[G = \gen{a,\,b \mid a^4 = b^4 = 1,\ a^2 = b^2,\ b^{-1}ab = a^{-1}}\]
        Which we recognise as the quaternion group, \(Q_8\).
\end{case}
\end{proof}

So (\ref{eqn:p_cubed_abelian}), together with the two lemmas, prove Theorem~\ref{thm:p_cubed}.

